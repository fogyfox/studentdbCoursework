<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Админ панель</title>
    <style>
        .tab { display: none; }
        .tab.active { display: block; }
        button.tab-button { margin-right: 5px; margin-bottom:5px; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 15px; }
        th, td { border: 1px solid #aaa; padding: 5px; text-align: left; }
    </style>
</head>
<body>

<h2>Админ панель</h2>

<!-- Кнопки вкладок -->
<div>
    <button class="tab-button" data-tab="users">Пользователи</button>
    <button class="tab-button" data-tab="students">Студенты</button>
    <button class="tab-button" data-tab="teachers">Преподаватели</button>
    <button class="tab-button" data-tab="courses">Предметы</button>
    <button class="tab-button" data-tab="groups">Группы</button>
</div>

<!-- ========================= -->
<!-- Вкладка: Пользователи -->
<!-- ========================= -->
<div id="users" class="tab active">
    <h3>Пользователи</h3>
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>ФИО</th> <th>Логин</th>
            <th>Роль</th>
            <th>Действия</th>
        </tr>
        </thead>
        <tbody id="usersTable"></tbody>
    </table>

    <h4>Добавить пользователя</h4>
    <input id="newUserFirstName" placeholder="Имя"> <input id="newUserLastName" placeholder="Фамилия"> <input id="newUserLogin" placeholder="Логин">
    <input id="newUserPassword" type="password" placeholder="Пароль">
    <select id="newUserRole">
        <option value="STUDENT">STUDENT</option>
        <option value="TEACHER">TEACHER</option>
        <option value="ADMIN">ADMIN</option>
    </select>
    <button id="addUserBtn">Создать</button>
</div>

<!-- ========================= -->
<!-- Вкладка: Студенты -->
<!-- ========================= -->
<div id="students" class="tab">
    <h3>Студенты</h3>
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Имя</th>
            <th>Фамилия</th>
            <th>Логин</th>
            <th>Дата рождения</th>
            <th>Группа</th>
            <th>Действия</th>
        </tr>
        </thead>
        <tbody id="studentsTable"></tbody>
    </table>

    <h4>Добавить студента</h4>
    <input id="newStudentFirstName" placeholder="Имя">
    <input id="newStudentLastName" placeholder="Фамилия">
    <input id="newStudentDob" type="date">
    <input id="newStudentGroup" placeholder="ID группы">
    <input id="newStudentLogin" placeholder="Логин">
    <input id="newStudentPassword" type="password" placeholder="Пароль">
    <button id="addStudentBtn">Создать</button>
</div>

<!-- Вкладка: Преподаватели -->
<div id="teachers" class="tab">
    <h3>Преподаватели</h3>
    
    <!-- Таблица преподавателей -->
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Имя</th>
            <th>Фамилия</th>
            <th>Логин</th>
            <th>Группы (кураторство)</th>
            <th>Действия</th>
        </tr>
        </thead>
        <tbody id="teachersListTable"></tbody> <!-- Исправил ID для ясности -->
    </table>

    <!-- Форма создания (Точь-в-точь как у студентов) -->
    <h4>Добавить преподавателя</h4>
    <input id="newTeacherFirstName" placeholder="Имя">
    <input id="newTeacherLastName" placeholder="Фамилия">
    <input id="newTeacherLogin" placeholder="Логин">
    <input id="newTeacherPassword" type="password" placeholder="Пароль">
    <input id="newTeacherGroups" placeholder="ID групп (через запятую: 1, 2)">
    <button id="addTeacherBtn">Создать</button>

    <hr style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">

    <!-- Блок назначения нагрузки (сделан тоже в минималистичном стиле) -->
    <h3>Управление нагрузкой (Расписание)</h3>
    <div style="margin-bottom: 15px;">
        <label>Кто:</label> <select id="loadTeacherSelect" style="margin-right: 10px;"></select>
        <label>Предмет:</label> <select id="loadCourseSelect" style="margin-right: 10px;"></select>
        <label>Группа:</label> <select id="loadGroupSelect" style="margin-right: 10px;"></select>
        <button onclick="assignTeacherLoad()">Назначить</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>Преподаватель</th>
                <th>Предмет</th>
                <th>Группа</th>
                <th>Действие</th>
            </tr>
        </thead>
        <tbody id="teachersLoadList"></tbody>
    </table>
</div>

<!-- ========================= -->
<!-- Вкладка: Предметы -->
<!-- ========================= -->
<div id="courses" class="tab">
    <h3>Предметы</h3>
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Название</th>
            <th>Действия</th>
        </tr>
        </thead>
        <tbody id="coursesTable"></tbody>
    </table>

    <h4>Добавить предмет</h4>
    <input id="newSubjectName" placeholder="Название предмета">
    <button id="addCourseBtn">Создать</button>
</div>

<!-- Вкладка: Группы -->
<div id="groups" class="tab">
    <h3>Управление группами</h3>
    
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Название</th>
                <th>Студентов</th> <!-- Новая полезная колонка -->
                <th>Действия</th>
            </tr>
        </thead>
        <tbody id="groupsListTable"></tbody> <!-- Дали четкий ID -->
    </table>

    <h4>Создать новую группу</h4>
    <!-- Форма в одну строку -->
    <div style="display: flex; gap: 10px; align-items: center;">
        <input id="newGroupName" type="text" placeholder="Название (напр. ПОВТ-21)" style="flex: 1; max-width: 300px;">
        <button id="addGroupBtn" style="white-space: nowrap;">Создать группу</button>
    </div>
</div>

<script src="js/api.js"></script>
<script src="js/admin.js"></script>
<script>
const role = sessionStorage.getItem("role");
if (role !== "ADMIN") {
    alert("Доступ запрещён");
    location.href = "index.html";
}





/* =========================
   Переключение вкладок
========================= */
document.querySelectorAll(".tab-button").forEach(btn => {
    btn.addEventListener("click", () => {
        document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
        document.getElementById(btn.dataset.tab).classList.add("active");

        // ЗАМЕНИ ЭТО:
        if (btn.dataset.tab === "users") renderUsers();
        if (btn.dataset.tab === "students") renderStudents();
        if (btn.dataset.tab === "teachers") renderTeachers();
        if (btn.dataset.tab === "courses") renderCourses();
        if (btn.dataset.tab === "groups") renderGroups();
    });
});

// =========================
// Инициализация вкладки по умолчанию
// =========================
renderUsers();
renderCourses();

</script>
</body>
</html>
